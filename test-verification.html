<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¤œè¨¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #333; color: white; }
        .test-section { margin: 20px 0; padding: 15px; background: #444; border-radius: 10px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .pass { background: #4CAF50; }
        .fail { background: #f44336; }
        .warning { background: #FF9800; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ»æ¤œè¨¼æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>æ§‹æ–‡ãƒã‚§ãƒƒã‚¯</h2>
        <div id="syntaxTest"></div>
    </div>
    
    <div class="test-section">
        <h2>æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h2>
        <button onclick="testGameEngineExtensions()">GameEngineæ‹¡å¼µãƒ†ã‚¹ãƒˆ</button>
        <button onclick="testUIElements()">UIè¦ç´ ãƒ†ã‚¹ãƒˆ</button>
        <button onclick="testErrorSimulation()">ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</button>
        <div id="functionalTest"></div>
    </div>
    
    <script src="three.min.js"></script>
    <script>
        // åŸºæœ¬çš„ãªæ§‹æ–‡ãƒã‚§ãƒƒã‚¯
        function runSyntaxCheck() {
            const results = [];
            
            try {
                // GameEngineæ‹¡å¼µã®ãƒã‚§ãƒƒã‚¯
                const gameEngineCode = `
                    // ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰
                    this.wireframeMode = false;
                    this.originalMaterials = new Map();
                    
                    // ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
                    toggleWireframeMode() {
                        this.wireframeMode = !this.wireframeMode;
                        return this.wireframeMode;
                    }
                    
                    // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                    simulateError(errorType) {
                        console.log('ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³:', errorType);
                    }
                    
                    // æ¤œè¨¼ã‚¹ã‚­ãƒ¼ãƒ å®Ÿè¡Œ
                    runVerificationScheme() {
                        return {
                            timestamp: new Date().toISOString(),
                            tests: []
                        };
                    }
                `;
                
                eval(`(function() { ${gameEngineCode} })`);
                results.push({ name: 'GameEngineæ‹¡å¼µæ§‹æ–‡', status: 'PASS' });
            } catch (error) {
                results.push({ name: 'GameEngineæ‹¡å¼µæ§‹æ–‡', status: 'FAIL', error: error.message });
            }
            
            try {
                // UIé–¢æ•°ã®ãƒã‚§ãƒƒã‚¯
                const uiFunctions = `
                    function toggleDebugPanel() {
                        const panel = document.getElementById('debugPanel');
                        if (panel) panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                    }
                    
                    function toggleWireframe() {
                        console.log('wireframe toggle');
                    }
                    
                    function simulateError(errorType) {
                        console.log('simulate error:', errorType);
                    }
                    
                    function runVerification() {
                        console.log('run verification');
                    }
                `;
                
                eval(uiFunctions);
                results.push({ name: 'UIé–¢æ•°æ§‹æ–‡', status: 'PASS' });
            } catch (error) {
                results.push({ name: 'UIé–¢æ•°æ§‹æ–‡', status: 'FAIL', error: error.message });
            }
            
            return results;
        }
        
        function testGameEngineExtensions() {
            const results = [];
            
            try {
                // Mock GameEngine class
                class MockGameEngine {
                    constructor() {
                        this.wireframeMode = false;
                        this.originalMaterials = new Map();
                        this.scene = {
                            traverse: function(callback) {
                                // Mock some objects
                                callback({ isMesh: true, material: { wireframe: false, color: { setHex: () => {}, copy: () => {} }, map: null }, uuid: 'test1' });
                            }
                        };
                        this.renderer = { getClearColor: () => ({ getHex: () => 0x000000 }), setClearColor: () => {} };
                        this.camera = true;
                        this.fps = 60;
                    }
                    
                    toggleWireframeMode() {
                        this.wireframeMode = !this.wireframeMode;
                        this.scene.traverse((object) => {
                            if (object.isMesh && object.material) {
                                if (this.wireframeMode) {
                                    if (!this.originalMaterials.has(object.uuid)) {
                                        this.originalMaterials.set(object.uuid, { color: object.material.color, map: object.material.map });
                                    }
                                    object.material.wireframe = true;
                                    object.material.color.setHex(0x00ff00);
                                }
                            }
                        });
                        return this.wireframeMode;
                    }
                    
                    simulateError(errorType) {
                        switch (errorType) {
                            case 'rendering':
                                this.renderer.setClearColor(0xff0000);
                                break;
                            case 'texture':
                            case 'lighting':
                            case 'geometry':
                                console.log(`${errorType} error simulated`);
                                break;
                        }
                    }
                    
                    runVerificationScheme() {
                        const results = {
                            timestamp: new Date().toISOString(),
                            tests: []
                        };
                        
                        results.tests.push({
                            name: 'ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ¤œè¨¼',
                            status: this.renderer && this.scene && this.camera ? 'PASS' : 'FAIL',
                            details: `ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼: ${!!this.renderer}, ã‚·ãƒ¼ãƒ³: ${!!this.scene}, ã‚«ãƒ¡ãƒ©: ${!!this.camera}`
                        });
                        
                        results.tests.push({
                            name: 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼',
                            status: this.fps > 30 ? 'PASS' : this.fps > 15 ? 'WARNING' : 'FAIL',
                            details: `FPS: ${this.fps}`
                        });
                        
                        return results;
                    }
                }
                
                const mockEngine = new MockGameEngine();
                
                // Test wireframe toggle
                const wireframeResult = mockEngine.toggleWireframeMode();
                results.push({ 
                    name: 'ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ åˆ‡æ›¿', 
                    status: wireframeResult === true ? 'PASS' : 'FAIL',
                    details: `çµæœ: ${wireframeResult}`
                });
                
                // Test error simulation
                mockEngine.simulateError('rendering');
                results.push({ name: 'ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³', status: 'PASS', details: 'ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ©ãƒ¼ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ' });
                
                // Test verification scheme
                const verificationResults = mockEngine.runVerificationScheme();
                results.push({ 
                    name: 'æ¤œè¨¼ã‚¹ã‚­ãƒ¼ãƒ ', 
                    status: verificationResults.tests.length > 0 ? 'PASS' : 'FAIL',
                    details: `ãƒ†ã‚¹ãƒˆæ•°: ${verificationResults.tests.length}`
                });
                
            } catch (error) {
                results.push({ name: 'GameEngineæ‹¡å¼µ', status: 'FAIL', error: error.message });
            }
            
            displayResults('functionalTest', results);
        }
        
        function testUIElements() {
            const results = [];
            
            // Check if required HTML elements would exist
            const requiredElements = ['debugPanel', 'verificationResults'];
            requiredElements.forEach(id => {
                const exists = document.getElementById(id) !== null;
                results.push({
                    name: `UIè¦ç´ : ${id}`,
                    status: exists ? 'PASS' : 'WARNING',
                    details: exists ? 'è¦ç´ ãŒå­˜åœ¨' : 'ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã«ã¯å­˜åœ¨ã—ãªã„ï¼ˆæœ¬ä½“ã§ã¯å­˜åœ¨ã™ã‚‹äºˆå®šï¼‰'
                });
            });
            
            displayResults('functionalTest', results);
        }
        
        function testErrorSimulation() {
            const results = [];
            
            const errorTypes = ['rendering', 'texture', 'lighting', 'geometry'];
            errorTypes.forEach(type => {
                try {
                    // Mock error simulation
                    console.log(`Testing ${type} error simulation`);
                    results.push({
                        name: `${type}ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³`,
                        status: 'PASS',
                        details: 'ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æº–å‚™å®Œäº†'
                    });
                } catch (error) {
                    results.push({
                        name: `${type}ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³`,
                        status: 'FAIL',
                        error: error.message
                    });
                }
            });
            
            displayResults('functionalTest', results);
        }
        
        function displayResults(containerId, results) {
            const container = document.getElementById(containerId);
            let html = '';
            
            results.forEach(result => {
                const statusClass = result.status.toLowerCase();
                html += `
                    <div class="result ${statusClass}">
                        <strong>${result.name}:</strong> ${result.status}<br>
                        ${result.details ? `<small>${result.details}</small>` : ''}
                        ${result.error ? `<small>ã‚¨ãƒ©ãƒ¼: ${result.error}</small>` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Run syntax check on load
        window.addEventListener('load', () => {
            const syntaxResults = runSyntaxCheck();
            displayResults('syntaxTest', syntaxResults);
        });
    </script>
</body>
</html>